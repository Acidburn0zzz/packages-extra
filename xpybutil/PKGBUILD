# Contributor: Andrew Gallant <andrew@pytyle.com>
# Maintainer: Andrew Gallant
pkgname=xpybutil
pkgver=0.0.1
pkgrel=1
pkgdesc="A Python rendition of xcb-util. EWMH, ICCCM, key binding, Xinerama, etc..."
arch=('any')
url="http://burntsushi.net/X11/xpybutil"
license=('GPL')
groups=()
makedepends=('git')
depends=('python2>=2.7' 'xpyb')
optdepends=('python-imaging')
provides=('xpybutil-git')
conflicts=('xpybutil-git')
replaces=('xpybutil-git')
source=()
noextract=()
md5sums=()
_git=yes

getsource() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [ -d $1 ] ; then
    if [ "$_git" == "yes" ] ; then
       cd $1 && git pull origin master
    else
       cd $1 && git pull origin master && git checkout -b $pkgver
    fi
    msg "The local files are updated."
  else
    git clone $2 $1
    if [ "$_git" != "yes" ] ; then
       cd $1 && git checkout -b $pkgver $pkgver
    fi
  fi

  msg "GIT checkout done or server timeout"
}

package() {
  getsource "xpybutil" "git://github.com/BurntSushi/xpybutil.git"
  cd "${srcdir}/${pkgname}"
  msg "Starting make..."
  python2 ./setup.py install --root=$pkgdir || return 1
}
